# Isaac Sim GUI 相机朝向验证操作指南

> **创建时间**: 2026-01-27 12:30:00
> **目的**: 验证4向深度相机的朝向是否正确
> **适用场景**: Geo-Distill V2.2 首次训练前
> **验证对象**: Front(0°), Left(+90°), Back(180°), Right(-90°)

---

## 🎯 验证目标

你需要确认这4个相机是否朝向正确：

| 相机 | 期望朝向 | 验证方法 |
|------|---------|---------|
| **cam_front** | 朝前（机器人的正前方） | 能看到前方障碍物 |
| **cam_left** | 朝左（机器人的左侧） | 能看到左侧障碍物 |
| **cam_back** | 朝后（机器人的正后方） | 能看到后方障碍物 |
| **cam_right** | 朝右（机器人的右侧） | 能看到右侧障碍物 |

---

## 📝 操作步骤

### 步骤1：启动 Isaac Sim GUI

```bash
# 在项目目录下执行
cd ~/dashgo_rl_project
python train_v2.py --num_envs 1
```

**预期现象**：
- ✅ Isaac Sim 窗口会弹出
- ✅ 你能看到机器人和障碍物（红色圆柱、绿色方块）
- ✅ 场景中有1个DashGo机器人

**如果窗口没有弹出**：
- 检查是否正确安装了Isaac Sim
- 检查是否在正确的conda环境中：`conda activate env_isaaclab`

---

### 步骤2：找到相机列表

在 Isaac Sim 窗口中：

1. **打开 Stage 面板**
   - 位置：窗口左侧的 **Stage** 标签
   - 如果看不到：点击菜单 **Window → Stage**

2. **展开机器人层级**
   - 在 Stage 中找到：`/World/Default_0/Dashgo/base_link/`
   - 点击展开 ▶，你会看到：
     - `cam_front`
     - `cam_left`
     - `cam_back`
     - `cam_right`

**层级结构示例**：
```
World
└─ Default_0
   └─ Dashgo
      └─ base_link
         ├─ cam_front  ← 检查这个
         ├─ cam_left   ← 检查这个
         ├─ cam_back   ← 检查这个
         └─ cam_right  ← 检查这个
```

---

### 步骤3：验证前向相机 (cam_front)

#### 操作方法：

**方法1：右键菜单**
1. 右键点击 `cam_front`
2. 选择 **Inspect**
3. 在弹出的 **Viewport** 窗口中，你应该看到前方的视野

**方法2：选择相机视角**
1. 点击 `cam_front`（选中）
2. 在 **Viewport** 窗口上方，点击 **Select Camera** 按钮（📷 图标）
3. 视野会切换到相机的视角

#### ✅ 判断标准：

**正确（通过）**：
- 视野朝向机器人的正前方
- 能看到前方的障碍物（通常是红色圆柱或绿色方块）
- 地面在视野下方

**错误（不通过）**：
- 视野朝上/朝下（调整 `pos` 参数）
- 视野朝左/朝右（调整 `rot` 参数）
- 视野是黑屏（相机被遮挡，检查 `prim_path`）

**预期视野示意图**：
```
      (障碍物)
          ↓
   ┌─────────┐
   │  robot  │
   └─────────┘
```

---

### 步骤4：验证左侧相机 (cam_left)

**操作**：重复步骤3的方法，检查 `cam_left`

#### ✅ 判断标准：

**正确（通过）**：
- 视野朝向机器人的左侧
- 能看到左侧的障碍物

**预期视野示意图**：
```
      (障碍物)
          ←
   ┌─────────┐
   │  robot  │
   └─────────┘
```

---

### 步骤5：验证后向相机 (cam_back)

**操作**：重复步骤3的方法，检查 `cam_back`

#### ✅ 判断标准：

**正确（通过）**：
- 视野朝向机器人的正后方
- 能看到后方的障碍物

**预期视野示意图**：
```
   ┌─────────┐
   │  robot  │
   └─────────┘
      ↓
   (障碍物)
```

---

### 步骤6：验证右侧相机 (cam_right)

**操作**：重复步骤3的方法，检查 `cam_right`

#### ✅ 判断标准：

**正确（通过）**：
- 视野朝向机器人的右侧
- 能看到右侧的障碍物

**预期视野示意图**：
```
           (障碍物)
              →
   ┌─────────┐
   │  robot  │
   └─────────┘
```

---

## ✅ 验证清单

请逐个检查并勾选：

- [ ] **Front (0°)**：视野朝前，能看到前方障碍物
- [ ] **Left (+90°)**：视野朝左，能看到左侧障碍物
- [ ] **Back (180°)**：视野朝后，能看到后方障碍物
- [ ] **Right (-90°)**：视野朝右，能看到右侧障碍物

**结果**：
- ✅ 全部通过 → 相机配置正确，可以开始训练
- ❌ 有不通过的 → 需要修正四元数参数

---

## ⚠️ 如果发现相机朝向错误

### 常见错误1：相机装反了（左右颠倒）

**现象**：Front相机看到的是左边的场景

**解决**：检查 `dashgo_env_v2.py` 中的 `rot` 参数

**代码位置**：`dashgo_env_v2.py` 第900行左右

```python
# 检查这4行是否正确
camera_front = CameraCfg(..., rot=(1.0, 0.0, 0.0, 0.0))    # Front: 0°
camera_left = CameraCfg(..., rot=(0.707, 0.0, 0.0, 0.707))  # Left: +90°
camera_back = CameraCfg(..., rot=(0.0, 0.0, 1.0, 0.0))    # Back: 180°
camera_right = CameraCfg(..., rot=(-0.707, 0.0, 0.0, 0.707)) # Right: -90°
```

**四元数公式**：
- Front: `(cos0°, 0, 0, sin0°) = (1.0, 0.0, 0.0, 0.0)`
- Left: `(cos45°, 0, 0, sin45°) = (0.707, 0.0, 0.0, 0.707)`
- Back: `(cos90°, 0, 0, sin90°) = (0.0, 0.0, 1.0, 0.0)`
- Right: `(cos(-45°), 0, 0, sin(-45°)) = (0.707, 0.0, 0.0, -0.707)`

### 常见错误2：相机视野太窄/太宽

**现象**：FOV看起来不对（太窄或太宽）

**解决**：不要修改 `horizontal_aperture=20.955`，这是对应90° FOV的标准值

### 常见错误3：相机被遮挡

**现象**：相机视野黑屏

**解决**：
1. 检查 `pos=(0.0, 0.0, 0.13)` 安装高度是否合适
2. 检查机器人模型是否挡住了相机
3. 检查 `prim_path` 是否正确

---

## 📸 如何记录验证结果

**建议**：截图保存每个相机的视野

1. **切换到相机视角**（使用方法1或方法2）
2. **截图**：按 `Ctrl + Shift + S`（或菜单 **File → Screenshot**）
3. **保存文件名**：
   - Front相机：`verify_cam_front.png`
   - Left相机：`verify_cam_left.png`
   - Back相机：`verify_cam_back.png`
   - Right相机：`verify_cam_right.png`

---

## 🎓 验证通过后的下一步

### 如果全部通过 ✅

恭喜！相机配置完全正确，你可以：

1. **关闭 GUI**：关闭 Isaac Sim 窗口或按 `Ctrl+C`
2. **开始正式训练**：
   ```bash
   # ⚠️ 注意：必须加上 --enable_cameras 参数
   python train_v2.py --headless --enable_cameras --num_envs 64
   ```

**为什么需要 --enable_cameras？**
- 深度相机（Camera）需要渲染管线生成图像
- `--headless` 模式默认关闭渲染以节省资源
- `--enable_cameras` 强制启用后台渲染（无GUI但有渲染）

### 如果有错误 ❌

**请告诉我**：
1. 哪个相机有问题？
2. 看到的是什么景象？（简单描述）
3. 我会帮你修正四元数参数

---

## 📚 相关文档

- **实施记录**：`issues/2026-01-27_Geo-Distill-V2.2实施记录.md`
- **四元数公式表**：`docs/相机朝向验证指南_Geo-Distill-V2.2_2026-01-27.md`
- **相机配置**：`dashgo_env_v2.py` 第900-960行

---

**维护者**: Claude Code AI System (Robot-Nav-Architect Agent)
**项目**: DashGo机器人导航（Sim2Real）
**开发基准**: Isaac Sim 4.5 + Ubuntu 20.04
**状态**: 🟡 待验证

---

**准备好了吗？开始验证吧！** 🚀
