# Kaizen Four Pillars - 详细指南

## 1. Continuous Improvement (持续改进)

### 增量优于革命

**理念**:
- 做最小的可行改进
- 一次一个改进
- 验证每个更改后再进行下一个
- 通过小胜建立势头

**迭代优化三部曲**:
1. **第一版**: 让它工作
2. **第二遍**: 让它清晰
3. **第三遍**: 让它高效
4. 不要一次尝试全部

### 实践场景

**实现功能时**:
1. 从最简单的可行版本开始
2. 添加一个改进（错误处理、验证等）
3. 测试并验证
4. 如时间允许重复
5. 不要立即追求完美

**重构时**:
- 一次解决一个问题
- 每次改进后提交
- 保持测试通过
- 达到"足够好"时停止（边际收益递减）

**审查代码时**:
- 建议增量改进（非重写）
- 优先级：关键 → 重要 → 有则更好
- 首先专注于最高影响的更改
- 接受"比之前好"，即使不完美

---

## 2. Poka-Yoke (防错设计)

### 让错误不可能发生

**核心理念**:
- 类型系统捕获错误
- 编译器强制执行契约
- 无效状态不可表示
- 早期捕获错误（生产环境左侧）

### 分层防御

1. **类型系统**（编译时）
2. **验证**（运行时，早期）
3. **守卫**（前置条件）
4. **错误边界**（优雅降级）

### 实践场景

**设计API时**:
- 使用类型约束输入
- 使无效状态不可表示
- 返回Result<T, E>而非抛出
- 在类型中记录前置条件

**处理错误时**:
- 在系统边界验证
- 对前置条件使用守卫
- 快速失败，明确报错
- 记录上下文以调试

**配置时**:
- 必选而非可选+默认值
- 启动时验证所有配置
- 配置无效时失败部署
- 不允许部分配置

---

## 3. Standardized Work (标准化作业)

### 一致性胜过聪明

**原则**:
- 遵循现有代码库模式
- 不重新发明已解决的问题
- 仅在显著更好时使用新模式
- 团队对新模式达成一致

### 文档与代码共存

**标准文档结构**:
- README: 设置和架构
- CLAUDE.md: AI编码约定
- 注释: 解释"为什么"，而非"什么"
- 示例: 复杂模式

### 自动化标准

**工具强制执行**:
- Linter强制执行风格
- 类型检查强制执行契约
- 测试验证行为
- CI/CD强制执行质量门

### 实践场景

**添加新模式前**:
- 搜索代码库中类似问题的解决方案
- 检查CLAUDE.md的项目约定
- 如果打破模式与团队讨论
- 引入新模式时更新文档

**编写代码时**:
- 匹配现有文件结构
- 使用相同的命名约定
- 遵循相同的错误处理方法
- 从相同位置导入

**审查时**:
- 检查与现有代码的一致性
- 指向代码库中的示例
- 建议与标准对齐
- 如果新标准出现，更新CLAUDE.md

---

## 4. Just-In-Time (即时生产)

### YAGNI (You Aren't Gonna Need It)

**核心原则**:
- 仅实现当前需求
- 无"以防万一"功能
- 无"我们以后可能需要这个"的代码
- 删除投机性代码

### 最简单的可行方案

**策略**:
- 从直接解决方案开始
- 仅在需要时添加复杂度
- 需求变更时重构
- 不预测未来需求

### 基于测量优化

**流程**:
- 无过早优化
- 优化前先分析
- 测量更改的影响
- 接受"足够好"的性能

### 实践场景

**实现时**:
- 解决眼前的问题
- 使用直接的方法
- 抵制"如果"思维
- 删除投机性代码

**优化时**:
- 先分析，后优化
- 前后测量
- 记录为什么需要优化
- 在测试中保留简单版本

**抽象时**:
- 等待3+相似案例（Rule of Three）
- 尽可能使抽象简单
- 宁可重复不要错误抽象
- 模式清晰时重构

---

## 何时添加复杂度

**仅在以下情况**:
- 当前需求要求
- 通过使用识别出痛点
- 测量到性能问题
- 出现多个用例

**复杂度示例进化**:
```
Start: 简单函数
  ↓
Evolves: 需求变化，添加参数
  ↓
Evolves: 需求变化，使用库函数
  ↓
仅在需要时添加复杂度
```

---

## 抽象规则 (Rule of Three)

**何时抽象**:
- ✅ 3个或更多相似案例 → 抽象
- ❌ 1个案例 → 简单函数
- ⚠️ 2个案例 → 观察，等待第三个

**抽象原则**:
- 尽可能简单
- 宁可重复不要错误抽象
- 模式明确时重构
- 提取共同部分，保留差异

---

**文档版本**: v1.0
**创建日期**: 2026-01-17
**来源**: Kaizen v1.0 Four Pillars详细提取
