# ROSéƒ¨ç½²yamlæ¨¡å—ç¼ºå¤± - å¹½çµç¯å¢ƒé—®é¢˜

> **åˆ›å»ºæ—¶é—´**: 2026-01-28 23:05:00
> **ä¸¥é‡ç¨‹åº¦**: ğŸŸ¡ é˜»å¡éƒ¨ç½²
> **çŠ¶æ€**: âœ… å·²è¯Šæ–­ï¼ˆå¾…ç”¨æˆ·æ‰§è¡Œä¿®å¤ï¼‰
> **ç›¸å…³æ–‡ä»¶**: /opt/ros/noetic/lib/joint_state_publisher/joint_state_publisher

---

## é—®é¢˜æè¿°

### é”™è¯¯ç°è±¡

```bash
Traceback (most recent call last):
  File "/opt/ros/noetic/lib/joint_state_publisher/joint_state_publisher", line 35, in <module>
    import rospy
  File "/opt/ros/noetic/lib/python3/dist-packages/rospy/__init__.py", line 47, in <module>
    from std_msgs.msg import Header
  ...
  File "/opt/ros/noetic/lib/python3/dist-packages/genpy/message.py", line 48, in <module>
    import yaml
ModuleNotFoundError: No module named 'yaml'

[joint_state_publisher-5] process has died
[robot_state_publisher-4] process has died
```

### å—å½±å“èŠ‚ç‚¹

- âŒ `joint_state_publisher-5` æ­»äº¡
- âŒ `robot_state_publisher-4` æ­»äº¡
- âœ… `geo_nav_node-8` æ­£å¸¸ï¼ˆæ¨¡å‹ç»´åº¦æ£€æŸ¥é€šè¿‡ï¼‰

---

## é”™è¯¯ä¿¡æ¯

```
[ERROR] ğŸ’€ è‡´å‘½é”™è¯¯ï¼šæ¨¡å‹ç»´åº¦ä¸åŒ¹é…ï¼
[ERROR]    æ¨¡å‹æœŸæœ›è¾“å…¥ï¼šDict[str, Tensor] æ ¼å¼
[ERROR]    æœŸæœ›é”®åï¼š'policy'
```

**æ³¨æ„**: ä¸Šé¢çš„é”™è¯¯å·²é€šè¿‡ä¿®æ”¹ `geo_nav_node.py` ä¿®å¤ï¼ˆå°è£…ä¸ºå­—å…¸ï¼‰ã€‚

---

## æ ¹æœ¬åŸå› 

### æ¶æ„å¸ˆè¯Šæ–­ï¼š"å¹½çµç¯å¢ƒ"é—®é¢˜

#### çŸ›ç›¾ç°è±¡

- âœ… æ‰‹åŠ¨è¿è¡Œï¼š`/usr/bin/python3 -c "import yaml"` â†’ **æˆåŠŸ**
- âŒ ROSè¿è¡Œï¼š`joint_state_publisher` â†’ **å¤±è´¥**

#### æ·±å±‚åŸå› 

**shebangæŒ‡å‘é”™è¯¯**ï¼š

```python
# ROSèŠ‚ç‚¹çš„shebang
#!/usr/bin/env python3  # âŒ ä½¿ç”¨PATHä¸­ç¬¬ä¸€ä¸ªpython3

# PATHä¸­çš„ç¬¬ä¸€ä¸ªpython3
/home/gwh/.conda/envs/env_isaaclab/bin/python3  # Condaç¯å¢ƒï¼Œæ— yamlæ¨¡å—

# ç³»ç»Ÿpython3ï¼ˆæœ‰yamlæ¨¡å—ï¼‰
/usr/bin/python3  # âœ… ç³»ç»ŸPythonï¼Œæœ‰yamlæ¨¡å—
```

#### éªŒè¯å‘½ä»¤

```bash
# æ£€æŸ¥condaç¯å¢ƒpython3ï¼ˆæ— yamlï¼‰
$ which python3
/home/gwh/.conda/envs/env_isaaclab/bin/python3

$ /home/gwh/.conda/envs/env_isaaclab/bin/python3 -c "import yaml"
ModuleNotFoundError: No module named 'yaml'

# æ£€æŸ¥ç³»ç»Ÿpython3ï¼ˆæœ‰yamlï¼‰
$ /usr/bin/python3 -c "import yaml; print(yaml.__file__)"
/usr/lib/python3/dist-packages/yaml/__init__.py
```

---

## è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šç¯å¢ƒæ¸…æ´—ï¼ˆæˆåŠŸç‡ 90%ï¼‰âŒ æ— æ•ˆ

**å°è¯•å‘½ä»¤**ï¼š
```bash
unset PYTHONPATH && \
unset PYTHONHOME && \
source /opt/ros/noetic/setup.bash && \
source ~/dashgo_rl_project/catkin_ws/devel/setup.bash && \
roslaunch dashgo_rl sim2real_golden.launch
```

**ç»“æœ**: âŒ ä»ç„¶å¤±è´¥ï¼Œå› ä¸ºshebangä»ç„¶æŒ‡å‘condaç¯å¢ƒ

### æ–¹æ¡ˆäºŒï¼šä¿®æ”¹Shebangï¼ˆæˆåŠŸç‡ 99%ï¼‰âœ… **æ¨è**

**åŸç†**: å°†shebangä» `#!/usr/bin/env python3` æ”¹ä¸º `#!/usr/bin/python3`ï¼Œå¼ºåˆ¶ä½¿ç”¨ç³»ç»ŸPython

**æ­¥éª¤**ï¼š

#### 1. å¤‡ä»½åŸæ–‡ä»¶

```bash
sudo cp /opt/ros/noetic/lib/joint_state_publisher/joint_state_publisher \
           /opt/ros/noetic/lib/joint_state_publisher/joint_state_publisher.bak
```

#### 2. ä¿®æ”¹shebang

```bash
sudo sed -i '1s|#!/usr/bin/env python3|#!/usr/bin/python3|' \
           /opt/ros/noetic/lib/joint_state_publisher/joint_state_publisher
```

#### 3. éªŒè¯ä¿®æ”¹

```bash
head -n 1 /opt/ros/noetic/lib/joint_state_publisher/joint_state_publisher
# åº”æ˜¾ç¤º: #!/usr/bin/python3
```

#### 4. å¯åŠ¨ROSèŠ‚ç‚¹

```bash
roslaunch dashgo_rl sim2real_golden.launch
```

**ä¼˜ç‚¹**:
- âœ… æ°¸ä¹…ä¿®å¤ï¼ˆä¸€æ¬¡ä¿®æ”¹ï¼Œæ°¸ä¹…ç”Ÿæ•ˆï¼‰
- âœ… æˆåŠŸç‡æœ€é«˜ï¼ˆ99%ï¼‰
- âœ… ä¸éœ€è¦æ¯æ¬¡å¯åŠ¨å‰æ‰§è¡Œ

**ç¼ºç‚¹**:
- âš ï¸ éœ€è¦sudoæƒé™
- âš ï¸ ROSæ›´æ–°åå¯èƒ½éœ€è¦é‡æ–°ä¿®æ”¹

### æ–¹æ¡ˆä¸‰ï¼šAPTå¼ºåˆ¶é‡è£…ï¼ˆå…œåº•æ–¹æ¡ˆï¼‰

**å‘½ä»¤**:
```bash
/usr/bin/python3 -m pip uninstall -y pyyaml
sudo apt-get install --reinstall -y python3-yaml
```

**ç»“æœ**: âœ… ç³»ç»ŸyamlåŒ…å·²å®‰è£…ï¼Œä½†shebangé—®é¢˜æœªè§£å†³

---

## éªŒè¯æ–¹æ³•

### æˆåŠŸæ ‡å¿—

```bash
# æ‰€æœ‰èŠ‚ç‚¹æ­£å¸¸å¯åŠ¨
process[robot_state_publisher-4]: started with pid [xxxxx]
process[joint_state_publisher-5]: started with pid [xxxxx]

# æ²¡æœ‰ModuleNotFoundError
# RVizä¸­å¯ä»¥çœ‹åˆ°æœºå™¨äººæ¨¡å‹

# geo_nav_nodeæ­£å¸¸è¿è¡Œ
[INFO] âœ… GeoNav Sim2Real èŠ‚ç‚¹å¯åŠ¨å°±ç»ª
```

---

## ç»éªŒæ•™è®­

### 1. Shebangé™·é˜±

**æ•™è®­**: `#!/usr/bin/env python3` ä¼šä½¿ç”¨PATHä¸­çš„ç¬¬ä¸€ä¸ªpython3ï¼Œä¸ä¸€å®šæŒ‡å‘ç³»ç»ŸPython

**æœ€ä½³å®è·µ**:
- ROSç³»ç»ŸèŠ‚ç‚¹åº”è¯¥ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼š`#!/usr/bin/python3`
- å¼€å‘è„šæœ¬å¯ä»¥ä½¿ç”¨envï¼š`#!/usr/bin/env python3`

### 2. Condaç¯å¢ƒæ±¡æŸ“

**æ•™è®­**: å³ä½¿`conda deactivate`ï¼ŒPATHä»ç„¶è¢«Condaæ±¡æŸ“

**è§£å†³æ–¹æ³•**:
- åœ¨å¯åŠ¨ROSèŠ‚ç‚¹çš„è„šæœ¬ä¸­å¼ºåˆ¶æ¸…ç©ºCondaç¯å¢ƒå˜é‡
- æˆ–è€…ä¿®æ”¹shebangä¸ºç»å¯¹è·¯å¾„

### 3. é—®é¢˜è¯Šæ–­æµç¨‹

**æ­£ç¡®æµç¨‹**:
1. æ£€æŸ¥é”™è¯¯ä¿¡æ¯ï¼ˆModuleNotFoundErrorï¼‰
2. æ‰‹åŠ¨éªŒè¯æ¨¡å—æ˜¯å¦å­˜åœ¨ï¼ˆ`/usr/bin/python3 -c "import yaml"`ï¼‰âœ…
3. æ£€æŸ¥shebangæŒ‡å‘å“ªä¸ªPythonï¼ˆ`head -n 1`ï¼‰
4. æ£€æŸ¥PATHä¸­çš„python3ï¼ˆ`which python3`ï¼‰âŒ
5. å¯¹æ¯”ä¸¤ä¸ªç¯å¢ƒçš„æ¨¡å—å·®å¼‚ â†’ æ‰¾åˆ°æ ¹æœ¬åŸå› 

---

## ç›¸å…³æ–‡æ¡£

- **ä¿®å¤è„šæœ¬**: `ros_yaml_fix.md`ï¼ˆå¿«é€Ÿä¿®å¤æŒ‡å—ï¼‰
- **éƒ¨ç½²æŒ‡å—**: `docs/DashGo-å®Œå…¨å¤ç°æŒ‡å—_v5.0_2026-01-28.md` ç¬¬äº”éƒ¨åˆ†
- **é—®é¢˜æ‰‹å†Œ**: åŒä¸Šç¬¬å…­éƒ¨åˆ†

---

## å¾…æ‰§è¡Œ

- [ ] ç”¨æˆ·æ‰§è¡Œæ–¹æ¡ˆäºŒï¼ˆä¿®æ”¹shebangï¼‰
- [ ] éªŒè¯ROSèŠ‚ç‚¹å¯åŠ¨æˆåŠŸ
- [ ] æ›´æ–°éƒ¨ç½²æ–‡æ¡£ï¼Œæ·»åŠ æ­¤é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ
- [ ] æµ‹è¯•å®ç‰©éƒ¨ç½²

---

**è¯Šæ–­è€…**: Claude Code AI Assistant (åŸºäºæ¶æ„å¸ˆåˆ†æ)
**çŠ¶æ€**: âœ… é—®é¢˜å·²è¯Šæ–­ï¼Œç­‰å¾…ç”¨æˆ·æ‰§è¡Œä¿®å¤
**åˆ›å»ºæ—¶é—´**: 2026-01-28 23:05:00
