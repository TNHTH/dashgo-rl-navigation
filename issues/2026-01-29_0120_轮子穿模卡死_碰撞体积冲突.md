# 轮子穿模卡死问题 - 碰撞体积冲突

> **创建时间**: 2026-01-29 01:20:00
> **严重程度**: 🟡 警告（机器人无法移动）
> **状态**: ✅ 已修复
> **相关文件**: dashgo_d1_sim.urdf.xacro
> **对话来源**: dialogue-002-rviz-blind-diagnosis-physics-clipping.md

---

## 问题描述

### 现象：轮子原地空转

**症状**:
- 使用2D Nav Goal时，轮子原地空转
- 小车无法移动
- Gazebo中轮子嵌在主体里

**影响**:
- ❌ 机器人无法导航
- ❌ 轮子与底盘碰撞体积重叠
- ❌ 物理引擎判定为持续碰撞

---

## 根本原因

**诊断**: 物理模型的**碰撞体积（Collision Geometry）**冲突

**细节分析**:
- 底盘半径0.2m（直径0.4m）
- 轮距0.342m（轮子中心距离0.171m）
- 轮子有宽度，必然撞到底盘
- 物理引擎判定为持续碰撞，产生巨大摩擦力或死锁
- **结果**: 轮子转但车不动

---

## 解决方案：架构师"物理骨科手术"

### 修复1：修正底盘碰撞体积

**文件**: `dashgo_d1_sim.urdf.xacro`
**位置**: base_link的`<collision>`部分

**修改前**:
```xml
<collision>
  <geometry>
    <cylinder radius="0.2" length="0.21"/>
  </geometry>
</collision>
```

**修改后**:
```xml
<collision>
  <origin xyz="0 0 0" rpy="0 0 0"/>
  <geometry>
    <cylinder length="0.21" radius="0.16"/>  <!-- 0.2 → 0.16 -->
  </geometry>
</collision>
```

**架构师解释**:
> "我们要把机器人的底盘'削瘦'一点，或者把轮子往外挪一点，防止它们打架。"

### 修复2：添加轮子摩擦力属性

**文件**: `dashgo_d1_sim.urdf.xacro`

```xml
<!-- 左轮 -->
<gazebo reference="left_wheel_link">
  <mu1>1.0</mu1>  <!-- 摩擦系数 -->
  <mu2>1.0</mu2>
  <kp>1000000.0</kp>  <!-- 刚度 -->
  <kd>100.0</kd>  <!-- 阻尼 -->
  <minDepth>0.001</minDepth>  <!-- 防止穿透 -->
  <material>Gazebo/Black</material>
</gazebo>

<!-- 右轮 -->
<gazebo reference="right_wheel_link">
  <mu1>1.0</mu1>
  <mu2>1.0</mu2>
  <kp>1000000.0</kp>
  <kd>100.0</kd>
  <minDepth>0.001</minDepth>
  <material>Gazebo/Black</material>
</gazebo>
```

**参数说明**:
- `mu1/mu2`: 摩擦系数（1.0=正常橡胶，100=极高防滑）
- `kp/kd`: 刚度/阻尼系数（防止震荡）
- `minDepth`: 最小接触深度（防止穿透）

---

## 验证方法

### 1. 视觉检查

```bash
# 必须重启仿真才能生效
# 1. 停止roslaunch（Ctrl+C）
# 2. 重新启动
roslaunch dashgo_rl sim2real_golden.launch
```

- ✅ Gazebo中轮子不再嵌在身体里
- ✅ 轮子与底盘有明显间隙

### 2. 功能测试

- ✅ 使用2D Nav Goal时车子能移动
- ✅ 轮子转动时车身跟随移动
- ✅ 不再出现卡死现象

---

## 预期结果

- ✅ 机器人能正常移动
- ✅ 轮子不打滑
- ✅ 运动平滑，无震荡

---

## 经验教训

### 1. Visual vs Collision分离

**架构师强调**:
> "URDF里的`<visual>`和`<collision>`应该分开定义！"

**正确做法**:
```xml
<!-- Visual：用于显示，可以精细 -->
<visual>
  <geometry>
    <cylinder radius="0.20" length="0.21"/>
  </geometry>
</visual>

<!-- Collision：用于物理，应该简单 -->
<collision>
  <geometry>
    <cylinder radius="0.16" length="0.21"/>  <!-- 比Visual小 -->
  </geometry>
</collision>
```

### 2. 碰撞体积保守设计

**原则**:
- 底盘Collision半径应该小于Visual半径
- 轮子Collision不应该重叠
- 预留安装间隙（0.01-0.02m）

### 3. URDF修改后必须重启

⚠️ **重要**: Gazebo只在启动时加载URDF，运行中修改不会自动更新。

---

## 相关文档

- **完整对话**: `docs/architect-dialogues/dialogue-002-rviz-blind-diagnosis-physics-clipping.md`
- **URDF文件**: `catkin_ws/src/dashgo_rl/urdf/dashgo_d1_sim.urdf.xacro`
- **问题分析**: `docs/architect-dialogues/problem-solution-analysis.md` (P-005)

---

**维护者**: Claude Code AI Assistant (基于Isaac Sim架构师诊断)
