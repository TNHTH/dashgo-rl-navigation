# 心理咨询Agent v2.0方案 - Kaizen评估与优化报告（完整版）

**评估日期**: 2026-01-20
**评估方法**: Kaizen四大支柱 + 安全检测
**目标**: 识别风险、优化设计、确保安全

---

## 🔍 Kaizen四大支柱评估

### 1. Continuous Improvement (Kaizen) - 持续改进

#### ✅ 优点
- v1.0 → v2.0的增量升级路径清晰
- 从"AI编造"到"文档引用"的改进方向正确

#### ⚠️ 问题
**❌ 违反Kaizen原则：大爆炸式重写**

方案试图一次性集成所有功能，违反了"小改进，持续进行"的原则。

**改进建议（遵循增量原则）**：

```
Phase 1 (MVP) - 解决幻觉风险：
- 基础CBT工作表检索
- 简单认知扭曲识别
- MCP失败降级策略

Phase 2 (增强) - 添加斯多葛：
- 添加斯多葛哲学检索
- 完善认知偏差词典

Phase 3 (高级) - 人格分析：
- Big Five人格分析
- MBTI认知功能推断

Phase 4 (未来) - 长期追踪：
- 情绪时间线
- 实时监控
- 针对性提示
```

---

### 2. Poka-Yoke (防错设计) - 预防错误

#### ⚠️ 严重缺陷

**缺陷1：隐私泄露风险** 🚨

```javascript
// 方案中的示例代码（危险❌）
const thoughtRecord = await mcp__github__get_file_contents({
    owner: "sprypt",
    repo: "cbt-worksheets",
    path: "worksheets/thought-record-sheet.md"
});
// 问题：未脱敏的用户数据可能被记录到GitHub API logs
```

**防错设计**：

```markdown
## 强制隐私协议

### 数据脱敏层
在调用MCP前，必须脱敏：

❌ 错误（泄露隐私）：
analyze("王佳楼关系", "我担心她有男朋友")
→ 传递到GitHub API logs

✅ 正确（脱敏）：
sanitize("王佳楼") → "邻居A"
sanitize("我担心她有男朋友") → "fear_of_rejection"
→ 只传递抽象类型

### 本地优先策略
查询顺序：
1. 本地文档（Si Yuan/个人分析）
2. 缓存的MCP结果（.claude-cache/）
3. 最后才使用实时MCP
```

**缺陷2：MCP失败无降级方案** 🚨

```
用户求助 → AI调用MCP → 网络失败
→ 用户等待？错误提示？系统崩溃？（不可接受❌）
```

**防错设计（三层防御）**：

```markdown
## MCP失败降级策略

### Layer 1: 缓存层
首次MCP调用 → 缓存到 .claude-cache/cbt/
→ 后续优先使用缓存

### Layer 2: 本地文档层
缓存未命中 → 搜索本地文档
→ Si Yuan/个人分析/、self-reflection-agent/

### Layer 3: 降级到v1.0
以上都失败 → 使用内置CBT框架
→ 告知用户："基于本地文档分析（网络受限）"

### 禁止行为
❌ 直接报错"无法连接GitHub"
❌ 让用户等待无响应
❌ 空返回
```

---

### 3. Standardized Work (标准化作业) - 遵循标准

#### ⚠️ 问题

**❌ 未验证GitHub仓库的权威性**

方案提到的仓库未经验证：
- `sprypt/cbt-worksheets` - ❌ 搜索未找到
- `krasimir/daily-stoic` - ⚠️ 需验证
- `busterbenson/public` - ✅ 找到了，需验证质量

**验证标准**：

```markdown
## GitHub仓库验证标准（必须执行）

### 验证清单
对每个候选仓库，必须验证：

□ 学术认可度
  - 是否被学术论文引用？
  - 是否来自大学/研究机构？

□ 社区认可度
  - Star数 > 500？
  - 最近更新 < 1年？
  - 有活跃维护？

□ 内容质量
  - 是否引用原始研究？
  - 是否有清晰license？
  - README是否详细？

□ 可靠性
  - 作者是否是领域专家？
  - 是否有持续维护？

### 禁止使用
❌ 个人项目（Star < 100）
❌ 长期未更新（> 2年）
❌ 无license或license不明确
❌ 内容来源不明
```

---

### 4. Just-In-Time (即时生产) - YAGNI原则

#### ⚠️ 问题

**❌ 过度设计（违反YAGNI）**

方案包含太多功能，但用户当前只需要的：
1. ✅ CBT认知扭曲识别（王佳楼案例）
2. ✅ 苏格拉底式提问引导
3. ✅ 基于本地文档的分析

**不需要的（暂不实现）**：
- ⏸️ 实时监控（用户未要求）
- ⏸️ 针对性日记提示（用户未要求）
- ⏸️ Big Five自动化（可以手动分析）
- ⏸️ 情绪时间线可视化（需要明确需求）

**MVP定义**：

```markdown
## v2.0 MVP（最小可行产品）

v2.0 MVP = v1.0 + MCP CBT工作表 + MCP斯多葛哲学
= 只解决"幻觉风险"问题
= 其他功能后续迭代添加（YAGNI原则）

### MVP功能清单
✅ CBT工作表检索（解决幻觉）
✅ 斯多葛语录检索（增强引导）
✅ MCP失败降级（保证可用）
✅ 隐私脱敏协议（保证安全）

### 后续版本（v2.1+）
- Big Five自动化
- MBTI推断
- 情绪时间线
- （根据用户需求添加）
```

---

## 🚨 安全风险检测

### 风险1：隐私泄露

**严重性**：🔴 高危
**概率**：中

**问题**：
- MCP调用可能泄露用户敏感信息
- GitHub API logs可能记录分析内容
- 未经充分脱敏就调用外部服务

**缓解措施**：

```markdown
## 强制隐私协议（添加到Agent指令）

### 数据脱敏规则
在调用任何MCP工具前，必须：

1. 识别敏感信息
   - 人名 → 代号（A、B、邻居）
   - 地名 → 抽象化（学校、实验室）
   - 具体事件 → 类型标签（关系冲突）

2. 构建查询
   ❌ "分析王佳楼关系，我担心她有男朋友"
   ✅ "relationship_anxiety: fear_of_rejection"

3. 记录审计日志（本地）
   - 时间戳
   - 查询类型（脱敏后）
   - 仓库/文件路径
   - 不包含用户具体内容

### 禁止行为
❌ 将用户原话直接传递给MCP
❌ 包含可识别信息的MCP调用
❌ 未脱敏就记录分析内容
```

---

### 风险2：心理健康误诊

**严重性**：🔴 高危
**概率**：低

**问题**：
- Agent可能误判心理问题严重程度
- 缺少危机干预协议
- 未明确何时转介专业帮助

**缓解措施**：

```markdown
## 危机干预协议（强制执行）

### 触发条件（任一满足即触发）
- 用户表达自伤想法
- "我不想活了"、"活着没意义"
- 长期（>2周）严重情绪困扰
- 功能严重受损（无法工作/学习）

### 响应流程
1. 立即停止常规分析
2. 温和地表达关心
3. 提供专业求助资源
   - 心理援助热线
   - 当地心理咨询中心
4. 明确声明："我不是医生，无法提供医疗帮助"

### 禁止行为
❌ 试图诊断抑郁症/焦虑症
❌ 提供药物治疗建议
❌ 承诺"能解决"心理问题
❌ 轻化严重症状
```

---

### 风险3：MCP依赖

**严重性**：🟡 中危
**概率**：中

**问题**：
- 过度依赖GitHub MCP
- 网络问题导致功能失效
- 外部仓库不可控（可能删除/更新）

**缓解措施**：

```markdown
## MCP依赖缓解（三层防御）

### Layer 1: 本地缓存
首次调用 → 缓存到 .claude-cache/psych/
- cbt-worksheets/
- stoic-quotes/
- cognitive-bias/

### Layer 2: 降级到v1.0
MCP失败 → 自动降级到本地分析
- 告知用户："基于本地文档分析（网络受限）"
- 使用内置简化框架

### Layer 3: 离线优先
- 核心功能不依赖MCP
- MCP只是增强，不是必需
- 即使完全离线也能工作
```

---

## 📊 GitHub仓库权威性验证

基于搜索结果，以下是推荐的仓库：

### ✅ 推荐使用的仓库

#### 1. CBT资源
**仓库**: `cognitivetech/David-Burns-Feeling-Good-TEAM-CBT`
- **描述**: David Burns的CBT贡献精选列表（Feeling Good作者）
- **权威性**: ✅ David Burns是CBT领域权威专家
- **Star数**: 待验证（需访问查看）
- **推荐理由**: 基于Feeling Good一书（CBT经典教材）

#### 2. 斯多葛哲学
**仓库**: `benhoneywill/stoic-quotes`
- **描述**: 斯多葛语录应用（Seneca, Marcus Aurelius, Epictetus）
- **权威性**: ✅ 包含三大斯多葛哲学家原文
- **更新时间**: 2026-01-01（近期更新✅）
- **网站**: stoic-quotes.com
- **推荐理由**: 400+条精选语录，有网站支持

**备选**: `ersel/stoic-thoughts`
- **描述**: 400条斯多葛语录的shell脚本
- **简洁性**: ✅ 纯文本，易于解析

#### 3. 认知偏差词典
**仓库**: `busterbenson/public`
- **文件**: `cognitive-bias-cheat-sheet.json`
- **权威性**: ✅ Buster Benson（前Twitter产品经理）
- **推荐理由**: 广泛被引用的认知偏差分类

**注意**: 需验证175个偏差的分类科学性

### ❌ 不推荐的仓库

**仓库**: `tulikavijay/CBT-therapy`
- ❌ 目标是"诊断抑郁症"（超出Agent能力）
- ❌ 未明确学术背景
- ❌ 可能存在误诊风险

---

## 📋 优化后的方案

### v2.0 MVP（推荐实施）

```markdown
## 核心功能（只实现这些）

### 1. MCP CBT工作表检索
- 仓库: cognitivetech/David-Burns-Feeling-Good-TEAM-CBT
- 功能: 检索标准CBT工作表
- 降级: 本地缓存 → v1.0内置

### 2. MCP斯多葛语录检索
- 仓库: benhoneywill/stoic-quotes
- 功能: 检索400+条斯多葛语录
- 降级: 本地缓存 → v1.0内置

### 3. 认知偏差词典
- 仓库: busterbenson/public (cognitive-bias-cheat-sheet.json)
- 功能: 确认认知扭曲定义
- 降级: 本地缓存 → v1.0内置

### 4. 强制安全协议
- 隐私脱敏（调用MCP前）
- 危机干预（触发时）
- MCP失败降级（三层防御）

### 5. 保留v1.0功能
- 本地数据分析
- Big Five手动分析
- MBTI手动分析
- 情绪追踪（手动）

## 暂不实现（后续版本）
- ⏸️ 实时监控
- ⏸️ 自动化Big Five
- ⏸️ 针对性日记提示
- ⏸️ 情绪时间线可视化
```

---

## ✅ Kaizen改进建议总结

### 立即执行（P0）
1. ✅ 实施MCP失败降级策略（三层防御）
2. ✅ 添加强制隐私脱敏协议
3. ✅ 添加危机干预协议
4. ✅ 验证推荐仓库的可用性

### 短期改进（P1）
5. ✅ 缩小v2.0范围到MVP（只解决幻觉风险）
6. ✅ 本地缓存MCP结果
7. ✅ 添加MCP调用审计日志

### 长期优化（P2）
8. ⏸️ 根据用户需求添加Big Five自动化
9. ⏸️ 添加情绪时间线（用户明确要求后）
10. ⏸️ 针对性日记提示（用户明确要求后）

---

## 🎯 最终推荐

### 推荐方案：v2.0 MVP（渐进式）

**核心改进**：
1. 添加MCP CBT工作表检索（解决幻觉）
2. 添加MCP斯多葛语录检索（增强引导）
3. 添加MCP失败降级（保证可用）
4. 添加强制安全协议（保证安全）

**不包含**：
- ❌ 实时监控（过度设计）
- ❌ 自动化Big Five（非必需）
- ❌ 针对性日记提示（用户未要求）

**实施步骤**：
```
Phase 1: 安全协议
- 添加隐私脱敏规则
- 添加危机干预协议
- 添加MCP失败降级

Phase 2: MCP集成
- 验证推荐仓库
- 测试MCP调用
- 实施本地缓存

Phase 3: 测试验证
- 王佳楼案例分析
- 对比v1.0和v2.0
- 确认降级策略有效
```

---

## 📌 关键原则

**Kaizen哲学**：
- 小改进 > 大爆炸
- 预防错误 > 事后修补
- 遵循标准 > 盲目创新
- 只实现需要的 > 过度设计

**记住**：
- 安全第一（隐私、危机干预）
- 可用性第二（MCP失败降级）
- 功能第三（MVP范围）

---

**评估完成**: 2026-01-20
**下一步**: 等待用户确认后实施优化方案
