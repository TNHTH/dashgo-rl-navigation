<?xml version="1.0"?>
<launch>
    <!--
    ========================================================================
    DashGo RLå¯¼èˆª - å®žè½¦æŽ§åˆ¶Launchæ–‡ä»¶ï¼ˆç¬”è®°æœ¬è¿œç¨‹æŽ§åˆ¶ç‰ˆï¼‰

    ç‰ˆæœ¬: v1.0
    æ›´æ–°: 2026-01-28
    ä½œè€…: Based on Architect's recommendation

    è¯´æ˜Ž:
    - ä¸åŒ…å«Gazeboï¼ˆçœŸå®žä¸–ç•Œä¸éœ€è¦ä»¿çœŸå™¨ï¼‰
    - ä¸åŒ…å«SLAMï¼ˆé€šå¸¸è½¦ä¸Šç”µè„‘è¿è¡Œå»ºå›¾èŠ‚ç‚¹ï¼‰
    - åªè¿è¡ŒRLå¯¼èˆªèŠ‚ç‚¹å’Œå¯é€‰çš„æœ¬åœ°Rviz

    ä½¿ç”¨æ–¹æ³•:
    1. ç¡®ä¿å·²é…ç½®ROSå¤šæœºé€šè®¯ï¼ˆè¿è¡Œconnect_to_robot.shï¼‰
    2. å¯åŠ¨ï¼šroslaunch dashgo_rl real_control.launch

    ä¾èµ–:
    - æœºå™¨äººä¸Šä½æœºå·²å¯åŠ¨roscoreã€é©±åŠ¨ã€é›·è¾¾
    - å·²é…ç½®ROS_MASTER_URIå’ŒROS_IP
    ========================================================================
    -->

    <arg name="model_path" default="$(find dashgo_rl)/models/policy_torchscript.pt"
         doc="TorchScriptæ¨¡åž‹è·¯å¾„ï¼ˆç›¸å¯¹è·¯å¾„ï¼‰"/>

    <arg name="max_lin_vel" default="0.3"
         doc="æœ€å¤§çº¿é€Ÿåº¦ (m/s) - ä¸Ždashgo_config.pyä¸€è‡´"/>

    <arg name="max_ang_vel" default="1.0"
         doc="æœ€å¤§è§’é€Ÿåº¦ (rad/s) - ä¸Ždashgo_config.pyä¸€è‡´"/>

    <arg name="max_lin_acc" default="1.0"
         doc="æœ€å¤§çº¿åŠ é€Ÿåº¦ (m/sÂ²) - ä¸Ždashgo_config.pyä¸€è‡´"/>

    <arg name="max_ang_acc" default="0.6"
         doc="æœ€å¤§è§’åŠ é€Ÿåº¦ (rad/sÂ²) - ä¸Ždashgo_config.pyä¸€è‡´"/>

    <arg name="control_rate" default="20"
         doc="æŽ§åˆ¶é¢‘çŽ‡ (Hz) - å¿…é¡»ä¸Žåº•å±‚æŽ§åˆ¶å™¨åŒ¹é…"/>

    <arg name="enable_rviz" default="true"
         doc="æ˜¯å¦å¯åŠ¨æœ¬åœ°Rvizå¯è§†åŒ–"/>

    <arg name="rviz_config" default="$(find dashgo_rl)/rviz/nav_real.rviz"
         doc="Rvizé…ç½®æ–‡ä»¶è·¯å¾„ï¼ˆå¦‚æžœä¸å­˜åœ¨ä¼šä½¿ç”¨é»˜è®¤é…ç½®ï¼‰"/>

    <!-- ========================================================================
         RLå¯¼èˆªèŠ‚ç‚¹ï¼ˆæ ¸å¿ƒï¼‰
    ======================================================================== -->
    <node pkg="dashgo_rl" type="geo_nav_node.py" name="geo_nav_node"
          output="screen" required="true">

        <!-- æ¨¡åž‹è·¯å¾„ -->
        <param name="model_path" value="$(arg model_path)" />

        <!-- é€Ÿåº¦é™åˆ¶ï¼ˆä¸Ždashgo_config.pyä¸€è‡´ï¼‰ -->
        <param name="max_lin_vel" value="$(arg max_lin_vel)" />
        <param name="max_ang_vel" value="$(arg max_ang_vel)" />

        <!-- ðŸ”¥ [æ–°å¢ž] åŠ é€Ÿåº¦é™åˆ¶å‚æ•°ï¼ˆå®‰å…¨å…³é”®ï¼‰ -->
        <param name="max_lin_acc" value="$(arg max_lin_acc)" />
        <param name="max_ang_acc" value="$(arg max_ang_acc)" />

        <!-- ðŸ”¥ [æ–°å¢ž] æŽ§åˆ¶é¢‘çŽ‡ï¼ˆåŠ¨æ€è®¡ç®—dtï¼‰ -->
        <param name="control_rate" value="$(arg control_rate)" />
    </node>

    <!-- ========================================================================
         å¯é€‰ï¼šæœ¬åœ°Rvizå¯è§†åŒ–
    ======================================================================== -->
    <group if="$(arg enable_rviz)">
        <!-- æ£€æŸ¥RVizé…ç½®æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æžœä¸å­˜åœ¨ä½¿ç”¨é»˜è®¤é…ç½® -->
        <node pkg="rviz" type="rviz" name="rviz"
              args="-d $(arg rviz_config)"
              unless="$(eval not('$(exists $(arg rviz_config))'))"/>

        <!-- å¦‚æžœé…ç½®æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤é…ç½®å¯åŠ¨ -->
        <node pkg="rviz" type="rviz" name="rviz"
              if="$(eval not('$(exists $(arg rviz_config))'))"/>
    </group>

</launch>
