# 用户习惯追踪系统使用指南

**版本**: v2.0 (统一版)
**更新日期**: 2026-01-20
**核心理念**: 主Agent在后台默默记录、自动评估、持续优化，你完全感觉不到，但会越来越智能。

---

## 📌 核心理念

**极简版 = 我（主Agent）默默工作，你感觉不到我在学习**

```
正常对话 = 自动记录
任务完成 = 自动评估
积累数据 = 自动优化
```

---

## 🎯 工作原理

### 日常对话（后台静默记录）

```
你：帮我做一个博客

我：[正常回答你的问题]

    同时（后台，你完全感觉不到）：
    📝 记录：任务类型=Web开发
    📝 记录：启动了Product, Frontend, Backend
    📝 记录：你选择了Next.js + TypeScript
    📝 记录：开始时间 10:30
```

### 任务完成时（自动评估）

```
检测到以下信号：
• 你说"完成""好了""可以了"
• 你说"谢谢""感谢"
• 长时间无新消息
• 开始新话题

我自动（后台）：
1. 读取 task-evaluation-template.md（评估标准）
2. 评分：效率A/B/C/D，质量1-5分
3. 更新4个Memory实体
4. 简短反馈（可选）：
   "✅ 效率评分A级（35分钟，预计50分钟）"
```

### 每10个任务（自动深度分析）

```
任务数 = 10, 20, 30... 自动触发：

📊 深度分析报告（基于最近10个任务）
✅ 效率提升 20%
✅ 你偏好 TypeScript + Next.js
✅ 你喜欢简洁风格

下次建议：
- Web项目默认使用 Next.js
- 简单项目可以跳过 Architect
```

### 下次任务（自动应用学习）

```
你：帮我做个论坛

我：[自动读取Memory]
    根据你的习惯，我建议使用 Next.js + TypeScript
    （你之前10次Web项目都选了这个）

    [自动应用优化]
    - 跳过Architect（简单项目不需要）
    - 只启动 Product + Frontend + Backend
    - 预计40分钟完成

    [更准确、更快速、更个性化]
```

---

## 🗂️ Memory实体（4个核心）

### 1. UserProfile（用户画像）

```json
{
  "name": "User_16907_Profile",
  "entityType": "UserProfile",
  "observations": [
    "开发风格: 质量优先",
    "代码风格: 混用模式",
    "数据库策略: 根据项目选择",
    "总任务数: 0",
    "平均耗时: 0分钟"
  ]
}
```

**用途**: 存储你的整体特征和统计数据
**更新频率**: 每5个任务

### 2. TaskHistory（任务记录）

```json
{
  "name": "Task_20260112_103000",
  "entityType": "TaskHistory",
  "observations": [
    "任务类型: Web开发",
    "耗时: 45分钟",
    "Agents: Product, Frontend, Backend",
    "技术栈: Next.js, TypeScript",
    "效率评分: A",
    "质量评分: 4.5/5"
  ]
}
```

**用途**: 记录每个任务的详细信息
**更新频率**: 每个任务创建新实体

### 3. AgentPerformance（Agent性能）

```json
{
  "name": "Agent_Product_Performance",
  "entityType": "AgentPerformance",
  "observations": [
    "使用次数: 15",
    "成功率: 100%",
    "平均满意度: 4.6/5",
    "最佳场景: 需求模糊的项目"
  ]
}
```

**用途**: 追踪每个Agent的使用情况和表现
**更新频率**: 每个任务更新

### 4. OptimizationRules（优化规则）

```json
{
  "name": "OptimizationRules",
  "entityType": "OptimizationRules",
  "observations": [
    "简单项目(<5文件): Product + Frontend + CodeReviewer",
    "Web项目默认技术栈: Next.js, TypeScript",
    "质量优先项目: 必须包含CodeReviewer"
  ]
}
```

**用途**: 存储基于历史数据生成的优化建议
**更新频率**: 每10个任务

---

## 📊 评估标准

### 时间效率评分

- **A**: ≤ 预期耗时
- **B**: ≤ 预期耗时 × 1.2
- **C**: ≤ 预期耗时 × 1.5
- **D**: > 预期耗时 × 1.5

### 质量评分（1-5分）

- **功能完整性**: 是否实现所有需求？
- **准确性**: 是否有错误？
- **代码质量**: CodeReviewer发现的问题数

### 流程评分

- Agent选择是否合理
- 是否有冗余或缺失
- 协作是否顺畅

---

## ⚡ 自动触发时机

| 触发条件 | 自动执行 |
|----------|----------|
| **每个任务** | 后台静默记录到Memory |
| **任务完成** | 自动评估效率和质量，更新Memory |
| **每10个任务** | 深度分析，生成优化建议，展示报告 |
| **下次任务** | 自动读取Memory，应用学习成果 |

---

## 🚀 快速开始

### 第1步：初始化系统（可选）

**正常使用时**：不需要手动初始化，我会在第一次对话时自动创建Memory实体

**手动初始化**（如果想提前创建）：

```
请初始化用户习惯追踪系统
```

**系统会自动**：
1. 检查 Memory MCP 是否可用
2. 创建用户画像（UserProfile）
3. 为每个 Agent 创建性能追踪（AgentPerformance）
4. 创建优化规则库（OptimizationRules）
5. 创建行为模式追踪（UserPatterns）

**预期输出**：
```
✅ 用户画像已创建
✅ Agent 性能追踪已就绪
✅ 优化规则库已初始化
✅ 行为模式追踪已启动

📊 系统已启动，我将在后台默默学习你的偏好。
不会被注意到，但会持续优化你的工作效率。
```

---

## 📱 日常使用

### 自动工作（你不需要做任何事）

#### 1. 观察模式（默认）

在对话中，系统会默默记录：
- 你喜欢快速决策还是充分思考
- 你倾向的技术栈
- 你的沟通风格
- 你的质量 vs 速度权衡

#### 2. 评估模式（任务完成时自动触发）

当你完成任务后，系统会自动：
```
📊 正在分析任务完成情况...

✅ 效率评分：A级 (40分钟，预计60分钟)
🎯 完成度：100%
💯 质量评分：4.5/5

关键发现：
✅ 跳过 Architect 节省了 15 分钟
✅ 前后端并行协作顺畅

已更新：
- 任务统计 +1
- Agent 性能数据已更新
- 优化规则已微调

下次建议：
类似任务可直接使用 [Product + Frontend + Backend]
预计可节省 10 分钟
```

#### 3. 优化模式（每10个任务）

系统会深度分析：
```
🔍 深度分析报告（基于最近10个任务）

效率趋势：
⬆️ 时间效率提升 15%
⬆️ 质量稳定性提升 20%
⬇️ Token 消耗降低 10%

关键发现：
1. 你在简单项目中不喜欢过度设计
   → 已更新：简单项目跳过 Architect

2. 你更关注代码质量而非速度
   → 已更新：始终包含 CodeReviewer

3. 你偏好 TypeScript + React 组合
   → 已更新：Web 项目默认推荐该技术栈

优化建议：
- 继续保持质量优先的策略
- 可以尝试更多并行执行
- 考虑增加自动化测试
```

---

## 🔍 手动查询

### 查看用户画像

**提问**：
```
看看我的用户画像
```

**输出**：
```markdown
## 👤 用户画像报告

### 基本统计
- 总任务数: 25
- 平均耗时: 45分钟
- 平均满意度: 4.3/5

### 决策风格
- 规划倾向: 混合（简单任务快速，复杂任务详细）
- 风险偏好: 平衡
- 质量 vs 速度: 质量优先

### 技术偏好
- 主语言: TypeScript, Python
- 框架: React, Next.js, FastAPI
- 代码风格: 混用（OOP/FP/实用主义）
- 数据库: 根据项目选择

### 工作习惯
- 高效时段: 上午9-11点
- 任务类型分布: 开发(60%), 分析(20%), 学习(20%)
- 常用 Agents:
  1. Frontend Agent (18次)
  2. Product Agent (15次)
  3. CodeReviewer Agent (12次)

### 优化建议
基于你的历史数据：
✅ 继续保持质量优先的策略
✅ 简单项目可以跳过 Architect
✅ 上午时段最适合复杂任务
```

### 查看特定 Agent 的表现

**提问**：
```
Product Agent 表现如何？
```

**输出**：
```markdown
## 🤖 Product Agent 性能报告

### 基本统计
- 使用次数: 15次
- 成功率: 100%
- 平均满意度: 4.6/5
- 平均 Token 消耗: 1500

### 最佳适用场景
✅ 需求模糊的项目
✅ 需要技术选型的项目
✅ 创新型项目

### 不推荐场景
❌ 需求非常明确的项目（可能过度）
❌ 纯技术实现任务（不需要需求分析）

### 用户反馈
✅ "需求引导很清晰，帮我理清了思路" (8次)
✅ "选择题方式很好，节省时间" (5次)
⚠️  有2次觉得"问题有点多"

### 优化建议
对于需求明确的项目，可以：
- 直接使用简版需求确认
- 跳过部分引导问题
- 预计可节省 3-5 分钟
```

### 查看优化建议

**提问**：
```
有什么优化建议？
```

**输出**：
```markdown
## 💡 优化建议（基于你最近的25个任务）

### Agent 选择优化

**当前模式识别**：
- 简单项目（<5文件）：你倾向于跳过 Architect ✅
- 中等项目：你倾向于包含 Architect ✅
- 复杂项目：你倾向于使用全部 Agent ✅

**优化建议**：
1. 对于"快速原型"类任务，可以考虑只使用 [Product + Frontend]
   - 预计可节省 15 分钟
   - 适用于验证想法的场景

2. 对于"重构"类任务，可以考虑跳过 Product
   - 需求已经很明确
   - 直接进入 Architect + Backend
   - 预计可节省 10 分钟

### 流程优化

**发现的瓶颈**：
- CodeReviewer Agent 经常在任务最后才启动
- 导致如果有大问题需要大改

**建议**：
- 对于质量优先的项目（你的偏好），可以考虑：
  - Backend 完成后立即启动 CodeReviewer 检查后端
  - Frontend 完成后立即启动 CodeReviewer 检查前端
  - 并行进行，而不是最后统一检查

### 时间优化

**你的高效时段**：上午 9-11 点
**建议**：
- 复杂任务安排在上午
- 简单任务可以安排在下午

**你的效率趋势**：⬆️ 逐月提升 15%
**说明**：
- 1月平均耗时: 52分钟
- 2月平均耗时: 45分钟
- 3月平均耗时: 38分钟

继续保持！
```

---

## 🎮 你需要做的

### ✅ 正常说话就行

```
你：帮我做一个博客
你：优化这个函数
你：重构这个项目
```

### 📊 查看报告（可选）

```
你：看看我的用户画像
你：效率如何？
你：Product Agent表现如何？
```

### 🛑 控制（可选）

```
你：停止习惯追踪
你：删除今天的记录
```

---

## 🏆 优势

### 1. 完全透明
- 你感觉不到我在记录
- 不会干扰对话
- 只在关键时刻主动提示

### 2. 自动学习
- 越用越了解你
- 自动应用学习成果
- 持续优化体验

### 3. 可控
- 随时查看数据
- 随时停止追踪
- 随时删除历史

---

## 📁 文件结构

```
multi-agent-system/
├── shared/
│   └── task-evaluation-template.md    # 评估标准（我参考用）⭐核心
└── USER-TRACKING-GUIDE.md            # 本文件（完整使用指南）
```

---

## 🔄 版本对比

### 统一版 v2.0 vs 原设计

| 特性 | 原设计 | 统一版（推荐） |
|------|--------|----------------|
| 文件数 | 5个 | 2个 |
| Agent | 需要UserTracker Agent | 用主Agent |
| Skill | 需要track-habits Skill | 不需要 |
| 初始化 | 需要手动初始化 | 我自动创建 |
| 触发 | 需要命令 | 自动触发 |
| 复杂度 | 高 | 极低 |

**已删除的文件**：
- ❌ user-tracker.prompt.md
- ❌ track-habits.json
- ❌ user-tracking-memory-structure.md
- ❌ user-tracking-simple.md
- ❌ user-tracking-auto.md

**保留的文件**：
- ✅ task-evaluation-template.md（评估标准）
- ✅ USER-TRACKING-GUIDE.md（本文件）

---

## ❓ 常见问题

### Q1: 会影响性能吗？

**A**: 不会。追踪在后台异步进行，不会占用你的任务时间。

### Q2: 会记录隐私信息吗？

**A**: 不会。只记录：
- 任务类型和耗时
- 使用的 Agents
- 效率评分
- 技术栈偏好

不记录：
- 代码内容
- 文件名
- 敏感信息

### Q3: 可以关闭吗？

**A**: 可以。随时说"关闭习惯追踪"，或者删除历史数据。

### Q4: 数据保存在哪里？

**A**: 保存在 Memory MCP 中，在你的本地环境，不会上传到云端。

### Q5: 多久能看到效果？

**A**:
- **立即**：任务完成后的分析报告
- **短期**（10个任务后）：首次优化建议
- **长期**（30+任务后）：明显感受到个性化优化

### Q6: 会干扰我的工作吗？

**A**: 不会。系统设计为"默默观察"，只在关键时刻主动提示。大多数时候你感觉不到它的存在。

---

## 💡 最佳实践

### 1. 让它持续运行

不要频繁关闭追踪系统。它越了解你，就越能帮助你。

### 2. 定期查看报告

每完成 10-20 个任务后，查看一次优化建议，了解自己的工作模式。

### 3. 信任它的建议

系统基于数据分析生成建议，尝试应用，看看是否真的能提升效率。

### 4. 提供反馈

如果你觉得某些建议不好用，告诉系统。它会学习并调整。

---

## 📖 示例对话

### 日常使用（自动运行）

```
你: 帮我做一个待办事项应用

AI: [启动 Product Agent]
    好的！待办事项应用。先确认几个核心点：
    1. 主要功能？
    2. 使用场景？
    ...

你: [选择答案]

AI: [后台：UserTracker 正在记录]
    [启动 Architect Agent, Frontend Agent, Backend Agent]

    [开发进行中...]

    AI: 开发完成！已部署到本地。

    [后台：UserTracker 自动评估]

    📊 任务分析报告
    ✅ 效率评分：A级
    ⏱️ 耗时: 35分钟（平均45分钟）

    下次建议：
    - 类似任务可以直接跳过 Architect
    - 预计可节省 10 分钟
```

### 查询使用

```
你: 看看我的习惯

AI: [展示用户画像报告]

你: 我最常用的 Agents 是什么？

AI: 基于你的历史数据：
    1. Frontend Agent (18次, 满意度4.5/5)
    2. Product Agent (15次, 满意度4.6/5)
    3. CodeReviewer Agent (12次, 满意度4.2/5)

    似乎你更关注前端和产品质量！
```

---

## 🔧 高级功能

### 1. 自定义追踪偏好

**关闭特定类型的追踪**：

```
关闭习惯追踪，只保留效率评估
```

**只追踪技术偏好**：

```
只记录我的技术栈选择，不要观察沟通风格
```

### 2. 导出数据

**导出使用报告**：

```
导出我的使用数据（最近30天）
```

**输出**：
```markdown
## 📊 使用数据报告（2025-12-13 至 2026-01-12）

### 任务统计
- 总任务数: 25
- 总耗时: 18.5 小时
- 平均满意度: 4.3/5

### Agent 使用分布
```
[图表]
```

### Token 消耗
- 总消耗: 150,000 tokens
- 成本: 约 $2.25
- 平均每任务: 6,000 tokens

### 效率提升
- 时间效率: +15%
- 质量稳定性: +20%
- 满意度: +10%
```

### 3. 删除历史数据

**删除特定记录**：

```
删除今天的任务记录
```

**重置所有数据**：

```
重置习惯追踪系统
```

**警告**：重置会删除所有历史数据，重新开始学习。

---

## 🏗️ 系统架构

### 工作流程

```
你的对话
    ↓
UserTracker Agent（后台默默观察）
    ↓
检测到任务完成
    ↓
自动评估效率和质量
    ↓
更新 Memory
    ↓
生成优化建议
    ↓
下次任务自动应用优化
```

### Memory实体更新频率

| 实体 | 用途 | 更新频率 |
|------|------|----------|
| UserProfile | 用户画像 | 每5个任务 |
| TaskHistory | 任务记录 | 每个任务 |
| AgentPerformance | Agent性能 | 每个任务 |
| OptimizationRules | 优化规则 | 每10个任务 |

---

## 📝 更新日志

### v2.0 (2026-01-20) - 统一版
- ✅ 合并simple和auto版本到GUIDE
- ✅ 简化文件结构（从5个减少到2个）
- ✅ 优化核心理念章节
- ✅ 统一Memory实体为4个
- ✅ 添加版本对比表格
- ✅ 删除冗余文件

### v1.0 (2026-01-12) - 初始版
- ✅ 支持习惯追踪
- ✅ 支持任务评估
- ✅ 支持优化建议生成
- ✅ 支持用户画像报告

### 计划中
- [ ] 可视化仪表板
- [ ] 效率预测功能
- [ ] 团队协作模式
- [ ] 导出为 PDF 报告

---

## 🆘 获取帮助

如有问题或建议，随时询问：
```
习惯追踪系统有什么帮助？
如何优化我的工作流程？
```

系统会基于你的实际使用情况提供针对性建议。

---

## 🎯 总结

**这才是最优雅的实现！** 🚀

```
你：正常对话
    ↓
我：后台默默学习
    ↓
效果：越来越智能
```

**记住**：这个系统的目标是让你每次都比上次更高效！

---

**文档版本**: v2.0
**最后更新**: 2026-01-20
**维护者**: Multi-Agent System
